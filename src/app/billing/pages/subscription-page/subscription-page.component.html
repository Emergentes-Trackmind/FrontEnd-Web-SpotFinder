<div class="subscription-page">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <mat-icon class="header-icon">credit_card</mat-icon>
      <div>
        <h1>{{ 'BILLING.PAGE.TITLE' | translate }}</h1>
        <p>{{ 'BILLING.PAGE.SUBTITLE' | translate }}</p>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading()">
    <mat-spinner diameter="40"></mat-spinner>
    <p>{{ 'BILLING.LOADING' | translate }}</p>
  </div>

  <!-- Content -->
  <div class="page-content" *ngIf="!isLoading()">
    <mat-tab-group class="billing-tabs" animationDuration="300ms">

      <!-- Tab: Planes -->
      <mat-tab [label]="'BILLING.TAB.PLANS' | translate">
        <div class="tab-content">
          <div class="plans-grid">
            <app-plan-card
              *ngFor="let plan of plans()"
              [plan]="plan"
              [active]="isPlanActive(plan)"
              [ctaLabel]="getCtaLabel(plan)"
              (select)="onChoosePlan($event)">
            </app-plan-card>
          </div>

          <!-- Info adicional -->
          <div class="plans-info">
            <mat-icon>info</mat-icon>
            <p>{{ 'BILLING.PLANS.INFO' | translate }}</p>
          </div>
        </div>
      </mat-tab>

      <!-- Tab: Facturación -->
      <mat-tab [label]="'BILLING.TAB.BILLING' | translate">
        <div class="tab-content">
          <!-- Resumen de suscripción -->
          <div class="billing-section">
            <app-billing-summary
              [info]="subscriptionInfo()"
              (managePayment)="onManagePayment()"
              (cancel)="onCancelSubscription()">
            </app-billing-summary>
          </div>

          <!-- Historial de pagos -->
          <div class="billing-section">
            <app-payments-table
              [rows]="payments()">
            </app-payments-table>
          </div>
        </div>
      </mat-tab>

    </mat-tab-group>
  </div>
</div>
