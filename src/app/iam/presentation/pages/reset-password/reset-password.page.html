<div class="reset-password-container">
  <div class="reset-password-card">
    <mat-card>
      <mat-card-header>
        <div class="reset-header">
          <div class="logo-section">
            <mat-icon class="app-logo">local_parking</mat-icon>
            <h1>QuadrApp</h1>
          </div>
          <h2>Nueva Contraseña</h2>
          <p>Ingresa tu nueva contraseña segura</p>
        </div>
      </mat-card-header>

      <mat-card-content>
        <form [formGroup]="resetForm" (ngSubmit)="onSubmit()" class="reset-form">
          <div class="form-grid">
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Nueva Contraseña</mat-label>
              <input
                matInput
                [type]="hidePassword() ? 'password' : 'text'"
                formControlName="password"
                placeholder="Mínimo 8 caracteres"
                autocomplete="new-password"
              >
              <button
                mat-icon-button
                matSuffix
                type="button"
                (click)="togglePasswordVisibility('password')"
                [attr.aria-label]="'Toggle password visibility'"
              >
                <mat-icon>{{hidePassword() ? 'visibility_off' : 'visibility'}}</mat-icon>
              </button>
              <mat-error>{{ getFieldError('password') }}</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Confirmar Nueva Contraseña</mat-label>
              <input
                matInput
                [type]="hideConfirmPassword() ? 'password' : 'text'"
                formControlName="confirmPassword"
                placeholder="Repite tu nueva contraseña"
                autocomplete="new-password"
              >
              <button
                mat-icon-button
                matSuffix
                type="button"
                (click)="togglePasswordVisibility('confirmPassword')"
                [attr.aria-label]="'Toggle confirm password visibility'"
              >
                <mat-icon>{{hideConfirmPassword() ? 'visibility_off' : 'visibility'}}</mat-icon>
              </button>
              <mat-error>{{ getFieldError('confirmPassword') }}</mat-error>
            </mat-form-field>

            <div class="password-requirements">
              <h4>Requisitos de la contraseña:</h4>
              <ul>
                <li>Al menos 8 caracteres</li>
                <li>Una letra mayúscula</li>
                <li>Una letra minúscula</li>
                <li>Un número</li>
              </ul>
            </div>
          </div>

          <div class="form-actions">
            <button
              mat-raised-button
              type="submit"
              class="primary-button"
              [disabled]="isLoading() || !token()"
            >
              @if (isLoading()) {
                <mat-icon class="loading-icon">hourglass_empty</mat-icon>
                Actualizando...
              } @else {
                Cambiar Contraseña
              }
            </button>

            <div class="back-link">
              <a routerLink="/auth/login" class="link">
                <mat-icon>arrow_back</mat-icon>
                Volver al inicio de sesión
              </a>
            </div>
          </div>
        </form>
      </mat-card-content>
    </mat-card>
  </div>
</div>
